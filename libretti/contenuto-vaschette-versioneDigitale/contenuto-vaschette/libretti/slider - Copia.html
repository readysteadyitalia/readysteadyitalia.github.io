<!doctype html>
<html lang="en">
<head>
<title>Using turn.js and the new zoom feature</title>
<meta name="viewport" content="width = 1050, user-scalable = no" />

<script type="text/javascript" src="../../extras/jquery.min.1.7.js"></script>
<script type="text/javascript" src="../../extras/jquery-ui-1.8.20.custom.min.js"></script>
<script type="text/javascript" src="../../extras/modernizr.2.5.3.min.js"></script>
<script type="text/javascript" src="../../lib/hash.js"></script>
</head>
<body>

<div id="canvas">

	<div class="magazine-viewport">
		<div class="container">
			<div class="magazine">
				<!-- Next button -->
				<div ignore="1" class="next-button"></div>
				<!-- Previous button -->
				<div ignore="1" class="previous-button"></div>
			</div>
		</div>



	<div class="magazine-viewport1">
		<div class="container1">
			<div class="magazine1">
				<!-- Next button -->
				<div ignore="1" class="next-button"></div>
				<!-- Previous button -->
				<div ignore="1" class="previous-button"></div>
			</div>
		</div>
		</div>






</div>

<script type="text/javascript">

function loadApp() {

 	$('#canvas').fadeIn(1000);

  	var flipbook1 = $('.magazine1');
 	var flipbook = $('.magazine');


 	// Check if the CSS was already loaded

	if (flipbook.width()==0 || flipbook.height()==0) {
		setTimeout(loadApp, 10);
		return;
	}

	// Create the flipbook

	flipbook.turn({

			// Magazine width

			width: 30 +'%',

			// Magazine height

			height:  30 +'%',

			// Duration in millisecond

			duration: 1000,

			// Enables gradients

			gradients: true,

			// Auto center this flipbook

			autoCenter: true,

			// Elevation from the edge of the flipbook when turning a page

			elevation: 50,

			// The number of pages

			pages: 12,

			// Events

			when: {
				turning: function(event, page, view) {

					var book = $(this),
					currentPage = book.turn('page'),
					pages = book.turn('pages');

					// Update the current URI

					Hash.go('page/' + page).update();

					// Show and hide navigation buttons

					disableControls(page);

				},

				turned: function(event, page, view) {

					disableControls(page);

					$(this).turn('center');


					if (page==1) {
						$(this).turn('peel', 'br');
					}

				},

				missing: function (event, pages) {

					// Add pages that aren't in the magazine

					for (var i = 0; i < pages.length; i++)
						addPage(pages[i], $(this));

				}
			}

	});



	// Create the flipbook

	flipbook1.turn({

			// Magazine width

			width: 30 +'%',

			// Magazine height

			height:  30 +'%',

			// Duration in millisecond

			duration: 1000,

			// Enables gradients

			gradients: true,

			// Auto center this flipbook

			autoCenter: true,

			// Elevation from the edge of the flipbook when turning a page

			elevation: 50,

			// The number of pages

			pages: 12,

			// Events

			when: {
				turning: function(event, page, view) {

					var book = $(this),
					currentPage = book.turn('page'),
					pages = book.turn('pages');

					// Update the current URI

					Hash.go('page/' + page).update();

					// Show and hide navigation buttons

					disableControls1(page);

				},

				turned: function(event, page, view) {

					disableControls1(page);

					$(this).turn('center');



					if (page==1) {
						$(this).turn('peel', 'br');
					}

				},

				missing: function (event, pages) {

					// Add pages that aren't in the magazine

					for (var i = 0; i < pages.length; i++)
						addPage(pages[i], $(this));

				}
			}

	});

 var click = 0;
 var click1 = 0;

 		$('.magazine').on('mouseover', function() {click = 1; click1 = 0})
		$('.magazine1').on('mouseover', function() {click1 = 1; click = 0})

	// Using arrow keys to turn the page

	$(document).keydown(function(e){

		var previous = 37, next = 39, esc = 27;

		switch (e.keyCode) {
			case previous:

				// left arrow
				if(click == 1) {
				$('.magazine').turn('previous');}
				if(click1 == 1) {
				$('.magazine1').turn('previous');}
				e.preventDefault();

			break;
			case next:

				//right arrow
				if(click == 1) {
				$('.magazine').turn('next');}
				if(click1 ==1) {
				$('.magazine1').turn('next');}
				e.preventDefault();

			break;
			case esc:

				$('.magazine-viewport').zoom('zoomOut');
				e.preventDefault();

			break;
		}
	});





	// Events for the next button

	$(' .next-button').bind($.mouseEvents.over, function() {


		$(this).addClass('next-button-hover');

	}).bind($.mouseEvents.out, function() {

		$(this).removeClass('next-button-hover');

	}).bind($.mouseEvents.down, function() {

		$(this).addClass('next-button-down');

	}).bind($.mouseEvents.up, function() {

		$(this).removeClass('next-button-down');

	}).click(function() {

  if(click == 1) {
		$('.magazine').turn('next');}
	if(click1 == 1) {
			$('.magazine1').turn('next');}

	});

	// Events for the next button

	$(' .previous-button').bind($.mouseEvents.over, function() {

		$(this).addClass('previous-button-hover');

	}).bind($.mouseEvents.out, function() {

		$(this).removeClass('previous-button-hover');

	}).bind($.mouseEvents.down, function() {

		$(this).addClass('previous-button-down');

	}).bind($.mouseEvents.up, function() {

		$(this).removeClass('previous-button-down');

	}).click(function() {
    if(click == 1) {
		$('.magazine').turn('previous');}
		if(click1 == 1) {
		$('.magazine1').turn('previous');}
	});



}


// Load the HTML4 version if there's not CSS transform

yepnope({
	test : Modernizr.csstransforms,
	yep: ['../../lib/turn.min.js'],
	nope: ['../../lib/turn.html4.min.js'],
	both: ['css/jquery.ui.css', 'js/magazine.js', 'css/magazine.css'],
	complete: loadApp
});

</script>

</body>
</html>
